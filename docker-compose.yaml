version: '3.1'
services:    
  elasticsearch:
    image: 'docker.elastic.co/elasticsearch/elasticsearch:7.5.1'
    restart: always
#    network_mode: "host"
    ports:
      - "9200:9200"
    environment: 
      - discovery.type=single-node
      - cluster.name=datahack-nosql
      - http.cors.enabled=true
      - http.cors.allow-origin=*
      - path.repo=/usr/share/elasticsearch
      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
#    volumes:
#      - ".data/db/elasticsearch/data:/usr/share/elasticsearch/data"
  kibana:
    image: 'docker.elastic.co/kibana/kibana:7.5.1'
#    network_mode: "host"
    ports:
      - "5601:5601"
    environment:
      SERVER_NAME: datahack
      ELASTICSEARCH_HOSTS: http://elasticsearch:9200
  mongo:
    image: 'mongo:4.2'
    restart: always
#    network_mode: "host"
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: nosql
      MONGO_INITDB_ROOT_PASSWORD: nosql
  neo4j:
    image: 'neo4j:3.5.8'
    restart: always
#    network_mode: "host"
    ports:
      - "7474:7474"
#      - "7687:7687"
    environment:
      - NEO4J_AUTH=neo4j/1234    
  jupyter:
    image: 'rafaelgarrote/scipy-notebook:v0.3' 
    restart: always
#    network_mode: "host"
    ports:
      - "8888:8889"
    environment:
      - JUPYTER_LAB_ENABLE=yes
      - GRANT_SUDO=yes
    user: root  
    volumes: 
      - "./work:/home/jovyan/work"
    entrypoint: bash -c "start-notebook.sh --NotebookApp.token=''"  
